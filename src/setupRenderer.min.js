let globalLayoutData={};function groupLayoutsByFirstLetter(e){const t={};return e.forEach((e=>{const c=e.name[0].toUpperCase();t[c]||(t[c]=[]),t[c].push(e)})),t}function createLayoutSections(e,t=[]){const c=document.getElementById("layout-container");c.innerHTML="",Object.keys(e).sort().forEach((o=>{const a=document.createElement("div");a.className="letter-section";const n=document.createElement("div");n.className="letter-header",n.textContent=o,n.onclick=()=>{document.querySelectorAll(".letter-section").forEach((e=>e.classList.remove("active"))),a.classList.add("active")};const l=document.createElement("div");l.className="letter-content",e[o].forEach((e=>{const c=document.createElement("input");c.type="checkbox",c.value=e.id,c.className="layout-checkbox",t.includes(e.id)&&(c.checked=!0),c.addEventListener("change",(()=>{const e=Array.from(a.querySelectorAll(".layout-checkbox")).some((e=>e.checked));n.classList.toggle("selected",e)}));const o=document.createElement("label");o.className="layout-item",o.appendChild(c),o.appendChild(document.createTextNode(` ${e.name}`)),l.appendChild(o),l.appendChild(document.createElement("br"))})),a.appendChild(n),a.appendChild(l),c.appendChild(a);e[o].some((e=>t.includes(e.id)))&&n.classList.add("selected")}))}function getSelectedLayouts(e){const t=Array.from(document.querySelectorAll(".layout-checkbox:checked")).map((e=>e.value)),c=[];for(const o of Object.values(e))for(const e of o)t.includes(e.id)&&c.push(e);return c}fetch("keyboard_layouts.json").then((e=>e.json())).then((e=>{globalLayoutData=e,window.easykeyb.getLayouts().then((e=>{createLayoutSections(globalLayoutData,e)})),window.easykeyb.getLayouts().then((e=>{document.querySelectorAll(".layout-checkbox").forEach((t=>{e.includes(t.value)&&(t.checked=!0)}))}))})).catch((e=>{})),document.getElementById("ok-button").addEventListener("click",(()=>{const e=Array.from(document.querySelectorAll(".layout-checkbox:checked")).map((e=>e.value));window.easykeyb.saveLayouts(e),window.easykeyb.closeSetupWindow()})),document.getElementById("cancel-button").addEventListener("click",(()=>{window.easykeyb.closeSetupWindow()}));